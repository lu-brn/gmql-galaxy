<tool id="test_collections" name="Test Collections Management" version="0.1.0">
  <command>
    echo "A" > samples_RefSeqGenesExons_hg19.bed ;
    echo "B" > metadata_RefSeqGenesExons_hg19.meta;
    echo "C" > samples_TSS_hg19.bed;
    echo "D" > metadata_TSS_hg19.meta
  </command>
  <inputs>
    <param name="foo" type="text" label="Dummy Parameter" />
  </inputs>
  <outputs>
    <collection name="list_output" type="list:list" label="Duplicate List">
      <!-- Use named regex group to grab pattern
           <identifier_0>_<identifier_1>.fq. Here identifier_0 is the list
           identifier of the outer list and identifier_1 is the list identifier
           of the inner list (for instance oe1_ie2.fq in above example).
      -->
      <discover_datasets pattern="(?P&lt;identifier_0&gt;[^_]+)_(?P&lt;identifier_1&gt;.+)\.(?P&lt;ext&gt;[^\._]+)?" visible="true" />
    </collection>
  </outputs>
  <tests>
    <test>
      <param name="foo" value="bar" />
      <output_collection name="list_output" type="list:list">
        <element name="samples">
          <element name="RefSeqGenesExons_hg19">
            <assert_contents>
              <has_text_matching expression="^A\n$" />
            </assert_contents>
          </element>
	  <element name="TSS_hg19">
            <assert_contents>
              <has_text_matching expression="^C\n$" />
            </assert_contents>
          </element>
        </element>
        <element name="metadata">
          <element name="RefSeqGenesExons_hg19">
            <assert_contents>
              <has_text_matching expression="^B\n$" />
            </assert_contents>
          </element>
	  <element name="TSS_hg19">
            <assert_contents>
              <has_text_matching expression="^D\n$" />
            </assert_contents>
          </element>
        </element>
     </output_collection>
    </test>
  </tests>
</tool>
